{% extends 'partials/dms/base.html' %}
{% load static %}

{% block contents %}
                        <div class="d-xl-flex">
                            <div class="w-100">
                                <div class="d-md-flex">
                                    <div class="card filemanager-sidebar me-md-2">
                                        <div class="card-body">
        
                                            <div class="d-flex flex-column h-100">
                                                <div class="mb-4">
                                                    <div class="mb-3">
                                                        <div class="dropdown">
                                                            <button class="btn btn-primary w-100" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                <i class="mdi mdi-plus me-1"></i> Create 
                                                            </button>
                                                            <div class="dropdown-menu">
                                                              <a class="dropdown-item" href="{% url 'dms:create-folder' %}"><i class="bx bx-folder me-1"></i> Folder</a>
                                                              <a class="dropdown-item" href="{% url 'dms:new-file' %}"><i class="bx bx-file me-1"></i> File</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <ul class="list-unstyled categories-list">
                                                        <li>
                                                            <div class="custom-accordion">
                                                                <a class="text-body fw-medium py-1 d-flex align-items-center" data-bs-toggle="collapse" href="#categories-collapse" role="button" aria-expanded="false" aria-controls="categories-collapse">
                                                                    <i class="mdi mdi-folder font-size-16 text-primary me-2"></i> Folders <i class="mdi mdi-chevron-up accor-down-icon ms-auto"></i>
                                                                </a>
                                                                <div class="collapse show" id="categories-collapse">
                                                                    <div class="card border-0 shadow-none ps-2 mb-0">
                                                                        <ul class="list-unstyled mb-0">
                                                                            {% for cat in category_list %}
                                                                                {% if cat.pin_down %}
                                                                                    <li><a href="{% url 'dms:unpin-folder' cat.name %}" class="d-flex align-items-center"><span class="me-auto">{{cat.name}}</span> <i class="mdi mdi-pin ms-auto"></i></a></li>
                                                                                
                                                                                {% endif %}
                                                                            
                                                                            {% endfor %}
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div class="custom-accordion">
                                                                <a class="text-body fw-medium py-1 d-flex align-items-center" data-bs-toggle="collapse" href="#categories-collapse" role="button" aria-expanded="false" aria-controls="categories-collapse">
                                                                    <i class="mdi mdi-folder font-size-16 text-primary me-2"></i> Files <i class="mdi mdi-chevron-up accor-down-icon ms-auto"></i>
                                                                </a>
                                                                <div class="collapse show" id="categories-collapse">
                                                                    <div class="card border-0 shadow-none ps-2 mb-0">
                                                                        <ul class="list-unstyled mb-0">
                                                                            {% comment %} {% for cat in category_list %}
                                                                                {% if cat.pin_down %}
                                                                                    <li><a href="javascript: void(0);" class="d-flex align-items-center"><span class="me-auto">{{cat.name}}</span> <i class="mdi mdi-pin ms-auto"></i></a></li>
                                                                                
                                                                                {% endif %}
                                                                            
                                                                            {% endfor %} {% endcomment %}
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                       
                                                        <li>
                                                            <a href="javascript: void(0);" class="text-body d-flex align-items-center">
                                                                <i class="mdi mdi-trash-can text-danger font-size-16 me-2"></i> <span class="me-auto">Trash</span>
                                                            </a>
                                                        </li>
                                                        
                                                    </ul>
                                                </div>
        
                                                
                                            </div>
        
                                        </div>
                                    </div>
                                    <!-- filemanager-leftsidebar -->
        
                                    <div class="w-100">
                                        <div class="card">
                                            <div class="card-body">
                                                <div>
                                                    <div class="row mb-3">
                                                        <div class="col-xl-3 col-sm-6">
                                                            <div class="mt-2">
                                                                <h5>My Files</h5>
                                                            </div>
                                                        </div>
                                                        {% comment %} <div class="col-xl-9 col-sm-6">
                                                            <form class="mt-4 mt-sm-0 float-sm-end d-flex align-items-center">
                                                                <div class="search-box mb-2 me-2">
                                                                    <div class="position-relative">
                                                                        <input type="text" class="form-control bg-light border-light rounded" placeholder="Search...">
                                                                        <i class="bx bx-search-alt search-icon"></i>
                                                                    </div>
                                                                </div>
            
                                                                <div class="dropdown mb-0">
                                                                    <a class="btn btn-link text-muted mt-n2" role="button" data-bs-toggle="dropdown" aria-haspopup="true">
                                                                        <i class="mdi mdi-dots-vertical font-size-20"></i>
                                                                    </a>
                                                                  
                                                                    <div class="dropdown-menu dropdown-menu-end">
                                                                        <a class="dropdown-item" href="#">Share Files</a>
                                                                        <a class="dropdown-item" href="#">Share with me</a>
                                                                        <a class="dropdown-item" href="#">Other Actions</a>
                                                                    </div>
                                                                </div>
                                                                
                                                                
                                                            </form>
                                                        </div> {% endcomment %}
                                                    </div>
                                                </div>

                                                <div>
                                                    <div class="row">
                                                        {% if categorygroup %}
                                                            {% for cat in categorygroup %}
                                                            <div class="col-xl-4 col-sm-6">
                                                                <div class="card shadow-none border">
                                                                    <div class="card-body p-3">
                                                                        <div class="">
                                                                            <div class="float-end ms-2">
                                                                                <div class="dropdown mb-2">
                                                                                    <a class="font-size-16 text-muted" role="button" data-bs-toggle="dropdown" aria-haspopup="true">
                                                                                        <i class="mdi mdi-dots-horizontal"></i>
                                                                                    </a>
                                                                                    
                                                                                    <div class="dropdown-menu dropdown-menu-end">
                                                                                        <a class="dropdown-item" href="{% url 'dms:folder-detail' cat.category_id__name %}">Open</a>
                                                                                        {% if cat.category_id__name == 'In Bound' or cat.category_id__name == 'Draft' or cat.category_id__name == 'Out Bound' %}
                                                                                        
                                                                                        {% else %}
                                                                                            <a class="dropdown-item" href="{% url 'dms:edit-folder' cat.category_id__name %}">Edit</a>
                                                                                        {% endif %}
                                                                                        
                                                                                        {% if cat.category_id.pin_down  %}
                                                                                            <a class="dropdown-item" href="{% url 'dms:unpin-folder' cat.category_id__name %}">Unpin form Sidebar</a>
                                                                                        {% else %}
                                                                                            <a class="dropdown-item" href="{% url 'dms:pin-folder' cat.category_id__name %}">Pin to Sidebar</a>
                                                                                        {% endif %}
                                                                                        
                                                                                        <a class="dropdown-item" href="#">Rename</a>
                                                                                        <div class="dropdown-divider"></div>
                                                                                        <a class="dropdown-item" href="#">Remove</a>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="avatar-xs me-3 mb-3">
                                                                                <div class="avatar-title bg-transparent rounded">
                                                                                    <i class="bx bxs-folder font-size-24 text-primary"></i>
                                                                                </div>
                                                                            </div>
                                                                            <div class="d-flex">
                                                                                <div class="overflow-hidden me-auto">
                                                                                    <h5 class="font-size-14 text-truncate mb-1"><a href="javascript: void(0);" class="text-body">{{cat.category_id__name}}</a></h5>
                                                                                    <p class="text-muted text-truncate mb-0">{{cat.total}} Files</p>
                                                                                </div>
                                                                                {% comment %} <div class="align-self-end ms-2">
                                                                                    
                                                                                    <p class="text-danger mb-0">{{cat.new}} new files</p>
                                                                                </div> {% endcomment %}
                                                                            </div>
                                                                            
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                            </div>
                                                            {% endfor %}
                                                        {% else %}
                                                            {% for cat in category_list %}
                                                                <div class="col-xl-4 col-sm-6">
                                                                    <div class="card shadow-none border">
                                                                        <div class="card-body p-3">
                                                                            <div class="">
                                                                                <div class="float-end ms-2">
                                                                                    <div class="dropdown mb-2">
                                                                                        <a class="font-size-16 text-muted" role="button" data-bs-toggle="dropdown" aria-haspopup="true">
                                                                                            <i class="mdi mdi-dots-horizontal"></i>
                                                                                        </a>
                                                                                        
                                                                                        <div class="dropdown-menu dropdown-menu-end">
                                                                                            <a class="dropdown-item" href="#">Open</a>
                                                                                            <a class="dropdown-item" href="{% url 'dms:edit-folder' cat.id %}">Edit</a>
                                                                                            {% if cat.pin_down  %}
                                                                                                <a class="dropdown-item" href="{% url 'dms:unpin-folder' cat.id %}">Unpin form Sidebar</a>
                                                                                            {% else %}
                                                                                                <a class="dropdown-item" href="{% url 'dms:pin-folder' cat.id %}">Pin to Sidebar</a>
                                                                                            {% endif %}
                                                                                            
                                                                                            <a class="dropdown-item" href="#">Rename</a>
                                                                                            <div class="dropdown-divider"></div>
                                                                                            <a class="dropdown-item" href="#">Remove</a>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="avatar-xs me-3 mb-3">
                                                                                    <div class="avatar-title bg-transparent rounded">
                                                                                        <i class="bx bxs-folder font-size-24 text-primary"></i>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="d-flex">
                                                                                    <div class="overflow-hidden me-auto">
                                                                                        <h5 class="font-size-14 text-truncate mb-1"><a href="javascript: void(0);" class="text-body">{{cat.name}}</a></h5>
                                                                                        <p class="text-muted text-truncate mb-0">0 Files</p>
                                                                                    </div>
                                                                                    {% comment %} <div class="align-self-end ms-2">
                                                                                        <p class="text-muted mb-0">6GB</p>
                                                                                    </div> {% endcomment %}
                                                                                </div>
                                                                                
                                                                            </div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </div>
                                                            {% endfor %}
                                                        {% endif %}
                                                        
                                                        
                                                        <!-- end col -->
        
                                                        
        
                                                    </div>
                                                    <!-- end row -->
                                                </div>
        
                                                <div class="mt-4">
                                                    <div class="d-flex flex-wrap">
                                                        <h5 class="font-size-16 me-3">Recent Files</h5>
        
                                                        
                                                    </div>
                                                    <hr class="mt-2">
        
                                                    <div  class="table-responsive mb-4">
                                                        
                                                        <table class="table align-middle  table-hover mb-3">
                                                            <thead>
                                                                <tr>
                                                                  <th scope="col">Subject/Title</th>
                                                                  <th scope="col">Owner</th>
                                                                  <th scope="col"></th>
                                                                </tr>
                                                              </thead>
                                                            <tbody>
                                                                {% for data in latest_files %}
                                                                    <tr>
                                                                        <td>{{data.document_id.title}}</td>
                                                                        <td>{{data.staff.first_name }} {{ data.staff.first_name }}</td>
                                                                        
                                                                        <td>
                                                                            <div class="dropdown">
                                                                                <a class="font-size-16 text-muted" role="button" data-bs-toggle="dropdown" aria-haspopup="true">
                                                                                    <i class="mdi mdi-dots-horizontal"></i>
                                                                                </a>
                                                                                
                                                                                <div class="dropdown-menu ">
                                                                                    <a class="dropdown-item" href="{% url 'dms:view-document_detail' data.id %}">Open</a>
                                                                                    {% if category_id.name == "Draft"  %}
                                                                                        <a class="dropdown-item" href="#">Edit</a>
                                                                                        <a class="dropdown-item" href="#">Remove</a>
                                                                                    {% endif %}
                                                                                    
                                                                                    <div class="dropdown-divider"></div>
                                                                                    
                                                                                </div>
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                {% endfor %}
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- end card -->
                                    </div>
                                    <!-- end w-100 -->
                                </div>
                            </div>

                            <div class="card filemanager-sidebar ms-lg-2">
                                <div class="card-body">
                                    

                                    <div class="mt-4">
                                        {% for cat in categorygroup  %}
                                            <div class="card border shadow-none">
                                                <a href="javascript: void(0);" class="text-body">
                                                    <div class="p-2">
                                                        <div class="d-flex">
                                                            <div class="avatar-xs align-self-center me-2">
                                                                <div class="avatar-title rounded bg-transparent text-primary font-size-20">
                                                                    <i class="mdi mdi-folder"></i>
                                                                </div>
                                                            </div>
                                                            <div class="overflow-hidden me-auto">
                                                                <h5 class="font-size-13 text-truncate mb-1">{{cat.category_id__name}}</h5>
                                                                <p class="text-muted text-truncate mb-0">{{cat.total}} Files</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        {% endfor %}
                                        
                                    </div>
                                </div>
                            </div> 
                        </div>
                        <!-- end row -->
                
{% endblock %}
{% block extra_javascript %}
        <!-- apexcharts -->
        <script src="{% static 'libs/apexcharts/dist/apexcharts.min.js' %}"></script>
        <!-- file-manager js -->
        <script src="{% static 'js/pages/file-manager.init.js' %}"></script>
{% endblock %}