!function(){function e(e,t){var a=new XMLHttpRequest;a.open("GET",n+e,!0),a.responseType="json",a.onload=function(){var e=a.status;t(200===e?null:e,a.response)},a.send()}var s="users-chat",c="users",n="/static/json/",r="",o=1,l="/static/images/users/user-dummy-img.jpg";function d(e,t,a,s,n,c,r){var o='<div class="ctext-wrap">';if(null!=t)o+='<div class="ctext-wrap-content" id='+e+'>            <div class="conversation-name">'+r.name+'</div>            <p class="ctext-content">'+t+'</p>            <p class="chat-time mb-0"><i class="bx bx-time-five align-middle me-1"></i> '+c+"</p>            </div>";else if(a&&0<a.length){for(o+='<div class="ctext-wrap-content overflow-visible">            <div class="conversation-name">'+r.name+'</div>            <div class="message-img mb-0">',i=0;i<a.length;i++)o+='<div class="message-img-list">                <div>                    <a class="popup-img d-inline-block" href="'+a[i]+'">                        <img src="'+a[i]+'" alt="" class="rounded border">                    </a>                </div>                <div class="message-img-link">                <ul class="list-inline mb-0">                    <li class="list-inline-item dropdown">                        <a class="dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                            <i class="bx bx-dots-horizontal-rounded"></i>                        </a>                        <div class="dropdown-menu">                            <a class="dropdown-item" href="'+a[i]+'" download=""><i class="ri-download-2-line me-2 text-muted align-bottom"></i>Download</a>                            <a class="dropdown-item" href="#"><i class="ri-share-line me-2 text-muted align-bottom"></i>Forward</a>                            <a class="dropdown-item" href="#"><i class="ri-bookmark-line me-2 text-muted align-bottom"></i>Bookmark</a>                            <a class="dropdown-item delete-image" href="#"><i class="ri-delete-bin-5-line me-2 text-muted align-bottom"></i>Delete</a>                        </div>                    </li>                </ul>                </div>            </div>';o+='</div><p class="chat-time mt-1 mb-0"><i class="bx bx-time-five align-middle me-1"></i> '+c+"</p></div>"}else 0<s.length&&(o+='<div class="ctext-wrap-content">            <div class="p-3 border-primary border rounded-3">            <div class="d-flex align-items-center attached-file">                <div class="flex-shrink-0 avatar-sm me-3 ms-0 attached-file-avatar">                    <div class="avatar-title bg-soft-primary text-primary rounded-circle font-size-20">                        <i class="ri-attachment-2"></i>                    </div>                </div>                <div class="flex-grow-1 overflow-hidden">                    <div class="text-start">                        <h5 class="font-size-14 mb-1">design-phase-1-approved.pdf</h5>                        <p class="text-muted text-truncate font-size-13 mb-0">12.5 MB</p>                    </div>                </div>                <div class="flex-shrink-0 ms-4">                    <div class="d-flex gap-2 font-size-20 d-flex align-items-start">                        <div>                            <a href="#" class="text-muted">                                <i class="bx bxs-download"></i>                            </a>                        </div>                    </div>                </div>            </div>            </div>        </div>');return!0===n&&(o+='<div class="dropdown align-self-start message-box-drop">                <a class="dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                    <i class="bx bx-dots-vertical-rounded"></i>                </a>                <div class="dropdown-menu">                    <a class="dropdown-item" href="#">Forward</a>                    <a class="dropdown-item copy-message" href="#">Copy</a>                    <a class="dropdown-item" href="#">Bookmark</a>                    <a class="dropdown-item delete-item" href="#">Delete</a>                </div>            </div>'),o+="</div>"}function u(){"users"==c?(document.getElementById("channel-chat").style.display="none",document.getElementById("users-chat").style.display="block"):(document.getElementById("channel-chat").style.display="block",document.getElementById("users-chat").style.display="none"),t(n+"chats.json")}function t(e){var t,a;e=e,t=function(e,t){var n;null!==e?console.log("Something went wrong: "+e):(e="users"==c?t[0].chats:t[0].channel_chat,document.getElementById(c+"-conversation").innerHTML="",n=0,e.forEach(function(t,e){var a,s;0<n?n-=1:(s=t.from_id==o?" right":" left",a=r.find(function(e){return e.id==t.to_id}),s='<li class="chat-list'+s+'" id='+t.id+'>                        <div class="conversation-list">',s=(s+='<div class="user-chat-content">')+d(t.id,t.msg,t.has_images,t.has_files,t.has_dropDown,t.datetime,a)+"</div>                </div>            </li>",document.getElementById(c+"-conversation").innerHTML+=s)})),v.querySelectorAll(".delete-item").forEach(function(e){e.addEventListener("click",function(){(2==e.closest(".user-chat-content").childElementCount?e.closest(".chat-list"):e.closest(".ctext-wrap")).remove()})}),m.querySelectorAll(".delete-item").forEach(function(e){e.addEventListener("click",function(){(2==e.closest(".user-chat-content").childElementCount?e.closest(".chat-list"):e.closest(".ctext-wrap")).remove()})}),v.querySelectorAll(".chat-conversation-list .chat-list").forEach(function(e){e.querySelectorAll(".delete-image").forEach(function(e){e.addEventListener("click",function(){(1==e.closest(".message-img").childElementCount?e.closest(".chat-list"):e.closest(".message-img-list")).remove()})})}),v.querySelectorAll(".copy-message").forEach(function(t){t.addEventListener("click",function(){var e=t.closest(".ctext-wrap").children[0]?t.closest(".ctext-wrap").children[0].querySelector(".ctext-content").innerHTML:"";navigator.clipboard.writeText(e)})}),m.querySelectorAll(".copy-message").forEach(function(t){t.addEventListener("click",function(){var e=t.closest(".ctext-wrap").children[0]?t.closest(".ctext-wrap").children[0].querySelector(".ctext-content").innerHTML:"";navigator.clipboard.writeText(e)})}),document.querySelectorAll(".copy-message").forEach(function(e){e.addEventListener("click",function(){document.getElementById("copyClipBoard").style.display="block",document.getElementById("copyClipBoardChannel").style.display="block",setTimeout(function(){document.getElementById("copyClipBoard").style.display="none",document.getElementById("copyClipBoardChannel").style.display="none"},1e3)})}),$(".popup-img").magnificPopup({type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.'}}),p("users-chat")},(a=new XMLHttpRequest).open("GET",e,!0),a.responseType="json",a.onload=function(){var e=a.status;t(200===e?null:e,a.response)},a.send()}function a(){document.querySelectorAll(".user-chat");Array.from(document.querySelectorAll(".chat-user-list li a")).forEach(function(e){e.addEventListener("click",function(e){var t=document.querySelector(".chat-user-list li.active");t&&t.classList.remove("active"),this.parentNode.classList.add("active")})})}e("chat-users-list.json",function(e,t){null!==e?console.log("Something went wrong: "+e):(t[0].users.forEach(function(e,t){var a=e.profile?'<img src="'+e.profile+'" class="rounded-circle img-fluid userprofile" alt=""><span class="user-status"></span>':'<div class="avatar-title rounded-circle bg-primary bg-soft text-primary">'+e.nickname+'</div><span class="user-status"></span>',s=e.messagecount?'<div class="ms-2"><span class="badge badge-soft-dark rounded p-1">'+e.messagecount+"</span></div>":"",n=e.messagecount?'<a href="javascript: void(0);" class="unread-msg-user">':'<a href="javascript: void(0);">',i=1===e.id?"active":"";document.getElementById("userList").innerHTML+='<li id="contact-id-'+e.id+'" data-name="direct-message" class="'+i+'">                '+n+'                 <div class="d-flex">                    <div class="flex-shrink-0 align-self-center me-3 '+e.status+'">                        <i class="mdi mdi-circle font-size-10"></i>                    </div>                    <div class="flex-shrink-0 align-self-center me-3">                        <div class="avatar-xs">                        '+a+'                        </div>                    </div>                    <div class="flex-grow-1 overflow-hidden">                        <h5 class="text-truncate username font-size-14 mb-1">'+e.name+'</h5>                        <p class="text-truncate mb-0">'+e.recentMessage+'</p>                    </div>                    <div class="flex-shrink-0 align-self-center ms-2">                    <div class="font-size-11">'+e.time+"</div>                    "+s+"                    </div>                </div>            </a>        </li>"}),t[0].channels.forEach(function(e,t){var a=e.messagecount?'<div class="flex-shrink-0 ms-2"><span class="badge badge-soft-dark rounded p-1">'+e.messagecount+"</span></div>":"",s=(e.messagecount&&e.messagecount,e.messagecount?'<a href="javascript: void(0);" class="unread-msg-user">':'<a href="javascript: void(0);">');document.getElementById("channelList").innerHTML+='<li id="contact-id-'+e.id+'" data-name="channel">            '+s+'                 <div class="d-flex align-items-center">                    <div class="flex-shrink-0 me-3">                        <div class="avatar-xs">                            <div class="avatar-title rounded-circle bg-primary bg-soft text-primary">#</div>                        </div>                    </div>                    <div class="flex-grow-1 overflow-hidden">                        <h5 class="font-size-14 text-truncate mb-0">'+e.name+"</h5>                    </div>                    <div>"+a+"</div>                    </div>            </a>        </li>"})),a(),document.querySelectorAll("#userList li").forEach(function(a){a.addEventListener("click",function(){c="users",u(),s="users-chat";var e=a.getAttribute("id"),t=a.querySelector(".username").innerHTML;document.querySelector(".user-chat-topbar .text-truncate .username").innerHTML=t,document.getElementById(e).querySelector(".userprofile")?(e=document.getElementById(e).querySelector(".userprofile").getAttribute("src"),document.querySelector(".user-chat-topbar .avatar-xs").setAttribute("src",e)):document.querySelector(".user-chat-topbar .avatar-xs").setAttribute("src",l),document.getElementById("users-conversation").querySelectorAll(".left .conversation-name").forEach(function(e){e.innerHTML=t}),window.stop()})}),document.querySelectorAll("#channelList li").forEach(function(a){a.addEventListener("click",function(){c="channel",p(s="channel-chat"),u();var e=a.querySelector(".text-truncate").innerHTML,t=document.getElementById("channel-chat");t.querySelector(".user-chat-topbar .avatar-xs").setAttribute("src","/static/images/users/multi-user.jpg"),t.querySelector(".user-chat-topbar .text-truncate .username").innerHTML=e})})}),e("chat-contacts-list.json",function(e,t){var s,n;null!==e?console.log("Something went wrong: "+e):((r=t).sort(function(e,t){return e.name.localeCompare(t.name)}),n=s="",r.forEach(function(e,t){var a=e.profile?'<img src="'+e.profile+'" class="img-fluid rounded-circle" alt="">':'<span class="avatar-title rounded-circle bg-primary">'+e.nickname+"</span>",a=(s='<li>              <div class="d-flex align-items-center">                  <div class="flex-shrink-0 me-2">                      <div class="avatar-xs">                          '+a+'                      </div>                  </div>                  <div class="flex-grow-1">                  <p class="text-truncate contactlist-name mb-0">'+e.name+'</p>                  </div>                  <div class="flex-shrink-0">                      <div class="dropdown">                          <a href="#" class="text-muted font-size-18 px-2 d-block" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                          <i class="bx bx-dots-vertical-rounded"></i>                          </a>                          <div class="dropdown-menu dropdown-menu-end">                              <a class="dropdown-item" href="#"><i class="bx bx-pencil text-muted me-2"></i>Edit</a>                              <a class="dropdown-item" href="#"><i class="bx bx-block text-muted me-2"></i>Block</a>                              <a class="dropdown-item" href="#"><i class="bx bx-trash text-muted me-2"></i>Remove</a>                          </div>                      </div>                  </div>              </div>          </li>','<div class="mt-3" >              <div class="contact-list-title">'+e.name.charAt(0).toUpperCase()+'                </div>          <ul id="contact-sort-'+e.name.charAt(0)+'" class="list-unstyled contact-list" >');n!=e.name.charAt(0)&&(document.getElementsByClassName("sort-contact")[0].innerHTML+=a),document.getElementById("contact-sort-"+e.name.charAt(0)).innerHTML=document.getElementById("contact-sort-"+e.name.charAt(0)).innerHTML+s,n=e.name.charAt(0)})),document.querySelectorAll(".sort-contact ul li").forEach(function(s){s.addEventListener("click",function(e){c="users",u();var t,a=s.querySelector("li .contactlist-name").innerHTML;document.querySelector(".user-chat-topbar .text-truncate .username").innerHTML=a,s.querySelector(".align-items-center").querySelector(".avatar-xs img")?(t=s.querySelector(".align-items-center").querySelector(".avatar-xs .rounded-circle").getAttribute("src"),document.querySelector(".user-own-img .avatar-xs").setAttribute("src",t)):document.querySelector(".user-own-img .avatar-xs").setAttribute("src",l),document.getElementById("users-conversation").querySelectorAll(".left .conversation-name").forEach(function(e){e.innerHTML=a}),window.stop()})}),a()}),u();var m=document.querySelector("#channel-conversation");var v=document.querySelector(".chat-conversation-list");function p(a){setTimeout(function(){var e=document.getElementById(a).querySelector("#chat-conversation .simplebar-content-wrapper")?document.getElementById(a).querySelector("#chat-conversation .simplebar-content-wrapper"):"",t=document.getElementsByClassName("chat-conversation-list")[0]?document.getElementById(a).getElementsByClassName("chat-conversation-list")[0].scrollHeight-window.innerHeight+475:0;t&&e.scrollTo({top:t,behavior:"smooth"})},100)}var f=document.querySelector("#chatinput-form"),h=document.querySelector("#chat-input"),g=document.querySelector(".chat-input-feedback");function y(){var e=12<=(new Date).getHours()?"pm":"am",t=12<(new Date).getHours()?(new Date).getHours()%12:(new Date).getHours(),a=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes();return t<10?"0"+t+":"+a+" "+e:t+":"+a+" "+e}setInterval(y,1e3);var x=0,b=(f&&f.addEventListener("submit",function(e){e.preventDefault();var e=s,t=h.value;0===t.length?(g.classList.add("show"),setTimeout(function(){g.classList.remove("show")},2e3)):(b(e,t),p(e)),h.value=""}),function(e,t){x++;var a=document.getElementById(e).querySelector(".chat-conversation-list"),e=document.getElementById("user-name").innerHTML,s=(null!=t&&a.insertAdjacentHTML("beforeend",'<li class="chat-list right" id="chat-list-'+x+'" >                    <div class="conversation-list">                        <div class="user-chat-content">                            <div class="ctext-wrap">                                <div class="ctext-wrap-content">                                    <div class="conversation-name">'+e+'</div>                                    <p class="ctext-content">                                        '+t+'                                    </p>                                    <p class="chat-time mb-0"><i class="bx bx-time-five align-middle me-1"></i> '+y()+'</p>                                </div>                                <div class="dropdown align-self-start message-box-drop">                                    <a class="dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                                        <i class="bx bx-dots-vertical-rounded"></i>                                    </a>                                    <div class="dropdown-menu">                                        <a class="dropdown-item" href="#"><i class="ri-share-line me-2 text-muted align-bottom"></i>Forward</a>                                        <a class="dropdown-item copy-message" href="#""><i class="ri-file-copy-line me-2 text-muted align-bottom"></i>Copy</a>                                        <a class="dropdown-item" href="#"><i class="ri-bookmark-line me-2 text-muted align-bottom"></i>Bookmark</a>                                        <a class="dropdown-item delete-item" href="#"><i class="ri-delete-bin-5-line me-2 text-muted align-bottom"></i>Delete</a>                                </div>                            </div>                        </div>                    </div>                </div>            </li>'),document.getElementById("chat-list-"+x));s.querySelectorAll(".delete-item").forEach(function(e){e.addEventListener("click",function(){a.removeChild(s)})}),s.querySelectorAll(".copy-message").forEach(function(e){e.addEventListener("click",function(){var e=s.childNodes[1].firstElementChild.firstElementChild.firstElementChild.querySelector(".ctext-content").innerHTML;console.log(e),navigator.clipboard.writeText(e)})}),s.querySelectorAll(".copy-message").forEach(function(e){e.addEventListener("click",function(){document.getElementById("copyClipBoard").style.display="block",setTimeout(function(){document.getElementById("copyClipBoard").style.display="none"},1e3)})})})}();